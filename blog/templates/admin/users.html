{% extends 'admin/base.html' %}

<!-- header block -->
{% block header %}
<h1>{% block title %}Users{% endblock %}</h1>
{% endblock %}

<!-- content block -->
{% block main %} 

<h2 class="container my-5">All Users</h2>

<table class="table container my-5">
  <thead>
    <tr>
      <th scope="col">#</th>
      <th scope="col">First Name</th>
      <th scope="col">Last Name</th>
      <th scope="col">E-mail</th>
      <th scope="col">Role</th>
      <th scope="col">Active</th>
      <th scope="col">Remove</th>
      <th scope="col">Activate</th>
      <th scope="col">Deactivate</th>
    </tr>
  </thead>
  {% set count = namespace(value=1) %}
  <tbody>
  {% for user in users %}
  {%if user.active == True %}
  <tr>
      <th scope="row">{{ count.value }}</th>
      <td><a href="{{url_for('admin.view_user', id = user.id)}}">{{ user['first_name'] | title }}</a></td>
      <td><a href="{{url_for('admin.view_user', id = user.id)}}">{{ user['last_name'] | title }}</a></td>
      <td><a href="{{url_for('admin.view_user', id = user.id)}}">{{ user['email'] }}</a></td>
      <td><a href="{{url_for('admin.view_user', id = user.id)}}">{{ user['role'] }}</a></td>
      <td><a href="{{url_for('admin.view_user', id = user.id)}}">{{ user['active'] }}</a></td>
      {% if user['role'] != 'Admin' %}
      <td><a href="{{url_for('admin.delete_user', user_id = user.id)}}"><i class="fas fa-user-minus"></i></a></td>
      <td><a href="{{url_for('admin.activate_user', user_id = user.id)}}"><i class="fas fa-user" style="color:green;"></i></a></td>
      <td><a href="{{url_for('admin.deactivate_user', user_id = user.id)}}"><i class="fas fa-user-slash"></i></a></td>
      {%endif%}
    </tr>
    {%else%}
    <tr class="text-muted">
      <th scope="row">{{ count.value }}</th>
      <td><a class="text-muted" href="{{url_for('admin.view_user', id = user.id)}}">{{ user['first_name'] | title }}</a></td>
      <td><a class="text-muted" href="{{url_for('admin.view_user', id = user.id)}}"></a>{{ user['last_name'] | title }}</a></td>
      <td><a class="text-muted" href="{{url_for('admin.view_user', id = user.id)}}"></a>{{ user['email'] }}</a></td>
      <td><a class="text-muted" href="{{url_for('admin.view_user', id = user.id)}}"></a>{{ user['role'] }}</a></td>
      <td><a class="text-muted" href="{{url_for('admin.view_user', id = user.id)}}"></a>{{ user['active'] }}</a></td>
      {% if user['role'] != 'Admin' %}
      <td><a href="{{url_for('admin.delete_user', user_id = user.id)}}"><i class="fas fa-user-minus"></i></a></td>
      <td><a href="{{url_for('admin.activate_user', user_id = user.id)}}"><i class="fas fa-user"></i></i></a></td>
      <td><a href="{{url_for('admin.deactivate_user', user_id = user.id)}}"><i class="fas fa-user-slash" style="color:red;"></i></a></td>
      {%endif%}
    </tr>}
    {%endif%}

    {% set count.value = count.value + 1 %}
    {% endfor %} 
    </tbody>
  </table> 

{% endblock %}
